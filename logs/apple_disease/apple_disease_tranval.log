I1217 21:34:47.515269 19936 caffe.cpp:217] Using GPUs 0
I1217 21:34:47.522908 19936 caffe.cpp:222] GPU 0: GeForce GTX 1080 Ti
I1217 21:34:47.764302 19936 solver.cpp:48] Initializing solver from parameters: 
test_iter: 35
test_interval: 500
base_lr: 0.0001
display: 100
max_iter: 10000
lr_policy: "step"
gamma: 0.1
momentum: 0.9
weight_decay: 0.005
stepsize: 5000
snapshot: 1000
snapshot_prefix: "models/apple_disease/resnet50_train"
solver_mode: GPU
device_id: 0
net: "models/apple_disease/train_val_vgg16_reid.prototxt"
train_state {
  level: 0
  stage: ""
}
average_loss: 11
I1217 21:34:47.764454 19936 solver.cpp:91] Creating training net from net file: models/apple_disease/train_val_vgg16_reid.prototxt
I1217 21:34:47.765018 19936 net.cpp:322] The NetState phase (0) differed from the phase (1) specified by a rule in layer data
I1217 21:34:47.765060 19936 net.cpp:322] The NetState phase (0) differed from the phase (1) specified by a rule in layer accuracy
I1217 21:34:47.765208 19936 net.cpp:58] Initializing net from parameters: 
state {
  phase: TRAIN
  level: 0
  stage: ""
}
layer {
  name: "data"
  type: "ReidData"
  top: "data"
  top: "label"
  include {
    phase: TRAIN
  }
  transform_param {
    mirror: true
    crop_size: 224
    mean_value: 102.691
    mean_value: 128.77
    mean_value: 131.293
  }
  reid_data_param {
    source: "data/apple_disease/train.txt"
    batch_size: 2
    new_height: 256
    new_width: 256
    pos_fraction: 1
    neg_fraction: 1
    pos_limit: 1
    neg_limit: 8
    pos_factor: 1
    neg_factor: 1.01
    root_folder: "/media/agwang/\346\226\260\345\212\240\345\215\267/DataSets/Competitions/AppleDiseases/"
  }
}
layer {
  name: "conv1_1"
  type: "Convolution"
  bottom: "data"
  top: "conv1_1"
  param {
    lr_mult: 0
  }
  param {
    lr_mult: 0
  }
  convolution_param {
    num_output: 64
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "xavier"
    }
  }
}
layer {
  name: "relu1_1"
  type: "ReLU"
  bottom: "conv1_1"
  top: "conv1_1"
}
layer {
  name: "conv1_2"
  type: "Convolution"
  bottom: "conv1_1"
  top: "conv1_2"
  param {
    lr_mult: 0
  }
  param {
    lr_mult: 0
  }
  convolution_param {
    num_output: 64
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "xavier"
    }
  }
}
layer {
  name: "relu1_2"
  type: "ReLU"
  bottom: "conv1_2"
  top: "conv1_2"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1_2"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "conv2_1"
  type: "Convolution"
  bottom: "pool1"
  top: "conv2_1"
  param {
    lr_mult: 0
  }
  param {
    lr_mult: 0
  }
  convolution_param {
    num_output: 128
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "xavier"
    }
  }
}
layer {
  name: "relu2_1"
  type: "ReLU"
  bottom: "conv2_1"
  top: "conv2_1"
}
layer {
  name: "conv2_2"
  type: "Convolution"
  bottom: "conv2_1"
  top: "conv2_2"
  param {
    lr_mult: 0
  }
  param {
    lr_mult: 0
  }
  convolution_param {
    num_output: 128
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "xavier"
    }
  }
}
layer {
  name: "relu2_2"
  type: "ReLU"
  bottom: "conv2_2"
  top: "conv2_2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2_2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "conv3_1"
  type: "Convolution"
  bottom: "pool2"
  top: "conv3_1"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "xavier"
    }
  }
}
layer {
  name: "relu3_1"
  type: "ReLU"
  bottom: "conv3_1"
  top: "conv3_1"
}
layer {
  name: "conv3_2"
  type: "Convolution"
  bottom: "conv3_1"
  top: "conv3_2"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "xavier"
    }
  }
}
layer {
  name: "relu3_2"
  type: "ReLU"
  bottom: "conv3_2"
  top: "conv3_2"
}
layer {
  name: "conv3_3"
  type: "Convolution"
  bottom: "conv3_2"
  top: "conv3_3"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "xavier"
    }
  }
}
layer {
  name: "relu3_3"
  type: "ReLU"
  bottom: "conv3_3"
  top: "conv3_3"
}
layer {
  name: "pool3"
  type: "Pooling"
  bottom: "conv3_3"
  top: "pool3"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "conv4_1"
  type: "Convolution"
  bottom: "pool3"
  top: "conv4_1"
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "xavier"
    }
  }
}
layer {
  name: "relu4_1"
  type: "ReLU"
  bottom: "conv4_1"
  top: "conv4_1"
}
layer {
  name: "conv4_2"
  type: "Convolution"
  bottom: "conv4_1"
  top: "conv4_2"
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "xavier"
    }
  }
}
layer {
  name: "relu4_2"
  type: "ReLU"
  bottom: "conv4_2"
  top: "conv4_2"
}
layer {
  name: "conv4_3"
  type: "Convolution"
  bottom: "conv4_2"
  top: "conv4_3"
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "xavier"
    }
  }
}
layer {
  name: "relu4_3"
  type: "ReLU"
  bottom: "conv4_3"
  top: "conv4_3"
}
layer {
  name: "pool4"
  type: "Pooling"
  bottom: "conv4_3"
  top: "pool4"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "conv5_1"
  type: "Convolution"
  bottom: "pool4"
  top: "conv5_1"
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "xavier"
    }
  }
}
layer {
  name: "relu5_1"
  type: "ReLU"
  bottom: "conv5_1"
  top: "conv5_1"
}
layer {
  name: "conv5_2"
  type: "Convolution"
  bottom: "conv5_1"
  top: "conv5_2"
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "xavier"
    }
  }
}
layer {
  name: "relu5_2"
  type: "ReLU"
  bottom: "conv5_2"
  top: "conv5_2"
}
layer {
  name: "conv5_3"
  type: "Convolution"
  bottom: "conv5_2"
  top: "conv5_3"
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "xavier"
    }
  }
}
layer {
  name: "relu5_3"
  type: "ReLU"
  bottom: "conv5_3"
  top: "conv5_3"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5_3"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.6
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.6
  }
}
layer {
  name: "fc8-1"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8-1"
  inner_product_param {
    num_output: 9
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
  }
}
layer {
  name: "euclidean"
  type: "PairEuclidean"
  bottom: "fc7"
  bottom: "label"
  top: "euclidean"
  top: "label_dif"
}
layer {
  name: "fc8-1_dif"
  type: "InnerProduct"
  bottom: "euclidean"
  top: "fc8-1_dif"
  inner_product_param {
    num_output: 2
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
  }
}
layer {
  name: "loss"
  type: "SoftmaxWithLoss"
  bottom: "fc8-1"
  bottom: "label"
  top: "loss"
  loss_weight: 0.5
  propagate_down: true
  propagate_down: false
}
layer {
  name: "loss_dif"
  type: "SoftmaxWithLoss"
  bottom: "fc8-1_dif"
  bottom: "label_dif"
  top: "loss_dif"
  loss_weight: 0.2
  propagate_down: true
  propagate_down: false
}
I1217 21:34:47.765421 19936 layer_factory.hpp:77] Creating layer data
I1217 21:34:47.765455 19936 net.cpp:100] Creating Layer data
I1217 21:34:47.765463 19936 net.cpp:408] data -> data
I1217 21:34:47.765486 19936 net.cpp:408] data -> label
I1217 21:34:47.765920 19936 reid_data_layer.cpp:42] Opening file data/apple_disease/train.txt
I1217 21:34:47.766731 19936 reid_data_layer.cpp:68] A total of 2212 images. Label : [0, 8]
I1217 21:34:47.766739 19936 reid_data_layer.cpp:69] A total of 9 persons
I1217 21:35:13.409780 19936 reid_data_layer.cpp:104] output data size: 4,3,224,224
I1217 21:35:13.409883 19936 reid_data_layer.cpp:119] output label size : 4 (4)
I1217 21:35:13.419842 19936 net.cpp:150] Setting up data
I1217 21:35:13.419869 19936 net.cpp:157] Top shape: 4 3 224 224 (602112)
I1217 21:35:13.419876 19936 net.cpp:157] Top shape: 4 (4)
I1217 21:35:13.419878 19936 net.cpp:165] Memory required for data: 2408464
I1217 21:35:13.419886 19936 layer_factory.hpp:77] Creating layer label_data_1_split
I1217 21:35:13.419900 19936 net.cpp:100] Creating Layer label_data_1_split
I1217 21:35:13.419914 19936 net.cpp:434] label_data_1_split <- label
I1217 21:35:13.419924 19936 net.cpp:408] label_data_1_split -> label_data_1_split_0
I1217 21:35:13.419932 19936 net.cpp:408] label_data_1_split -> label_data_1_split_1
I1217 21:35:13.419975 19936 net.cpp:150] Setting up label_data_1_split
I1217 21:35:13.419982 19936 net.cpp:157] Top shape: 4 (4)
I1217 21:35:13.419986 19936 net.cpp:157] Top shape: 4 (4)
I1217 21:35:13.419987 19936 net.cpp:165] Memory required for data: 2408496
I1217 21:35:13.419991 19936 layer_factory.hpp:77] Creating layer conv1_1
I1217 21:35:13.420002 19936 net.cpp:100] Creating Layer conv1_1
I1217 21:35:13.420006 19936 net.cpp:434] conv1_1 <- data
I1217 21:35:13.420011 19936 net.cpp:408] conv1_1 -> conv1_1
I1217 21:35:13.671041 19936 net.cpp:150] Setting up conv1_1
I1217 21:35:13.671075 19936 net.cpp:157] Top shape: 4 64 224 224 (12845056)
I1217 21:35:13.671078 19936 net.cpp:165] Memory required for data: 53788720
I1217 21:35:13.671092 19936 layer_factory.hpp:77] Creating layer relu1_1
I1217 21:35:13.671102 19936 net.cpp:100] Creating Layer relu1_1
I1217 21:35:13.671108 19936 net.cpp:434] relu1_1 <- conv1_1
I1217 21:35:13.671116 19936 net.cpp:395] relu1_1 -> conv1_1 (in-place)
I1217 21:35:13.671273 19936 net.cpp:150] Setting up relu1_1
I1217 21:35:13.671283 19936 net.cpp:157] Top shape: 4 64 224 224 (12845056)
I1217 21:35:13.671294 19936 net.cpp:165] Memory required for data: 105168944
I1217 21:35:13.671298 19936 layer_factory.hpp:77] Creating layer conv1_2
I1217 21:35:13.671310 19936 net.cpp:100] Creating Layer conv1_2
I1217 21:35:13.671315 19936 net.cpp:434] conv1_2 <- conv1_1
I1217 21:35:13.671332 19936 net.cpp:408] conv1_2 -> conv1_2
I1217 21:35:13.672319 19936 net.cpp:150] Setting up conv1_2
I1217 21:35:13.672330 19936 net.cpp:157] Top shape: 4 64 224 224 (12845056)
I1217 21:35:13.672344 19936 net.cpp:165] Memory required for data: 156549168
I1217 21:35:13.672351 19936 layer_factory.hpp:77] Creating layer relu1_2
I1217 21:35:13.672360 19936 net.cpp:100] Creating Layer relu1_2
I1217 21:35:13.672364 19936 net.cpp:434] relu1_2 <- conv1_2
I1217 21:35:13.672370 19936 net.cpp:395] relu1_2 -> conv1_2 (in-place)
I1217 21:35:13.672497 19936 net.cpp:150] Setting up relu1_2
I1217 21:35:13.672507 19936 net.cpp:157] Top shape: 4 64 224 224 (12845056)
I1217 21:35:13.672510 19936 net.cpp:165] Memory required for data: 207929392
I1217 21:35:13.672516 19936 layer_factory.hpp:77] Creating layer pool1
I1217 21:35:13.672525 19936 net.cpp:100] Creating Layer pool1
I1217 21:35:13.672531 19936 net.cpp:434] pool1 <- conv1_2
I1217 21:35:13.672539 19936 net.cpp:408] pool1 -> pool1
I1217 21:35:13.672695 19936 net.cpp:150] Setting up pool1
I1217 21:35:13.672704 19936 net.cpp:157] Top shape: 4 64 112 112 (3211264)
I1217 21:35:13.672708 19936 net.cpp:165] Memory required for data: 220774448
I1217 21:35:13.672714 19936 layer_factory.hpp:77] Creating layer conv2_1
I1217 21:35:13.672725 19936 net.cpp:100] Creating Layer conv2_1
I1217 21:35:13.672731 19936 net.cpp:434] conv2_1 <- pool1
I1217 21:35:13.672740 19936 net.cpp:408] conv2_1 -> conv2_1
I1217 21:35:13.674674 19936 net.cpp:150] Setting up conv2_1
I1217 21:35:13.674693 19936 net.cpp:157] Top shape: 4 128 112 112 (6422528)
I1217 21:35:13.674715 19936 net.cpp:165] Memory required for data: 246464560
I1217 21:35:13.674731 19936 layer_factory.hpp:77] Creating layer relu2_1
I1217 21:35:13.674743 19936 net.cpp:100] Creating Layer relu2_1
I1217 21:35:13.674751 19936 net.cpp:434] relu2_1 <- conv2_1
I1217 21:35:13.674758 19936 net.cpp:395] relu2_1 -> conv2_1 (in-place)
I1217 21:35:13.675164 19936 net.cpp:150] Setting up relu2_1
I1217 21:35:13.675175 19936 net.cpp:157] Top shape: 4 128 112 112 (6422528)
I1217 21:35:13.675180 19936 net.cpp:165] Memory required for data: 272154672
I1217 21:35:13.675184 19936 layer_factory.hpp:77] Creating layer conv2_2
I1217 21:35:13.675196 19936 net.cpp:100] Creating Layer conv2_2
I1217 21:35:13.675204 19936 net.cpp:434] conv2_2 <- conv2_1
I1217 21:35:13.675212 19936 net.cpp:408] conv2_2 -> conv2_2
I1217 21:35:13.676689 19936 net.cpp:150] Setting up conv2_2
I1217 21:35:13.676702 19936 net.cpp:157] Top shape: 4 128 112 112 (6422528)
I1217 21:35:13.676707 19936 net.cpp:165] Memory required for data: 297844784
I1217 21:35:13.676715 19936 layer_factory.hpp:77] Creating layer relu2_2
I1217 21:35:13.676724 19936 net.cpp:100] Creating Layer relu2_2
I1217 21:35:13.676731 19936 net.cpp:434] relu2_2 <- conv2_2
I1217 21:35:13.676739 19936 net.cpp:395] relu2_2 -> conv2_2 (in-place)
I1217 21:35:13.677165 19936 net.cpp:150] Setting up relu2_2
I1217 21:35:13.677176 19936 net.cpp:157] Top shape: 4 128 112 112 (6422528)
I1217 21:35:13.677181 19936 net.cpp:165] Memory required for data: 323534896
I1217 21:35:13.677186 19936 layer_factory.hpp:77] Creating layer pool2
I1217 21:35:13.677197 19936 net.cpp:100] Creating Layer pool2
I1217 21:35:13.677203 19936 net.cpp:434] pool2 <- conv2_2
I1217 21:35:13.677211 19936 net.cpp:408] pool2 -> pool2
I1217 21:35:13.677356 19936 net.cpp:150] Setting up pool2
I1217 21:35:13.677364 19936 net.cpp:157] Top shape: 4 128 56 56 (1605632)
I1217 21:35:13.677367 19936 net.cpp:165] Memory required for data: 329957424
I1217 21:35:13.677371 19936 layer_factory.hpp:77] Creating layer conv3_1
I1217 21:35:13.677378 19936 net.cpp:100] Creating Layer conv3_1
I1217 21:35:13.677381 19936 net.cpp:434] conv3_1 <- pool2
I1217 21:35:13.677386 19936 net.cpp:408] conv3_1 -> conv3_1
I1217 21:35:13.680323 19936 net.cpp:150] Setting up conv3_1
I1217 21:35:13.680346 19936 net.cpp:157] Top shape: 4 256 56 56 (3211264)
I1217 21:35:13.680348 19936 net.cpp:165] Memory required for data: 342802480
I1217 21:35:13.680359 19936 layer_factory.hpp:77] Creating layer relu3_1
I1217 21:35:13.680368 19936 net.cpp:100] Creating Layer relu3_1
I1217 21:35:13.680372 19936 net.cpp:434] relu3_1 <- conv3_1
I1217 21:35:13.680377 19936 net.cpp:395] relu3_1 -> conv3_1 (in-place)
I1217 21:35:13.680510 19936 net.cpp:150] Setting up relu3_1
I1217 21:35:13.680518 19936 net.cpp:157] Top shape: 4 256 56 56 (3211264)
I1217 21:35:13.680522 19936 net.cpp:165] Memory required for data: 355647536
I1217 21:35:13.680524 19936 layer_factory.hpp:77] Creating layer conv3_2
I1217 21:35:13.680532 19936 net.cpp:100] Creating Layer conv3_2
I1217 21:35:13.680536 19936 net.cpp:434] conv3_2 <- conv3_1
I1217 21:35:13.680541 19936 net.cpp:408] conv3_2 -> conv3_2
I1217 21:35:13.685549 19936 net.cpp:150] Setting up conv3_2
I1217 21:35:13.685570 19936 net.cpp:157] Top shape: 4 256 56 56 (3211264)
I1217 21:35:13.685573 19936 net.cpp:165] Memory required for data: 368492592
I1217 21:35:13.685581 19936 layer_factory.hpp:77] Creating layer relu3_2
I1217 21:35:13.685591 19936 net.cpp:100] Creating Layer relu3_2
I1217 21:35:13.685598 19936 net.cpp:434] relu3_2 <- conv3_2
I1217 21:35:13.685608 19936 net.cpp:395] relu3_2 -> conv3_2 (in-place)
I1217 21:35:13.685752 19936 net.cpp:150] Setting up relu3_2
I1217 21:35:13.685761 19936 net.cpp:157] Top shape: 4 256 56 56 (3211264)
I1217 21:35:13.685765 19936 net.cpp:165] Memory required for data: 381337648
I1217 21:35:13.685770 19936 layer_factory.hpp:77] Creating layer conv3_3
I1217 21:35:13.685786 19936 net.cpp:100] Creating Layer conv3_3
I1217 21:35:13.685793 19936 net.cpp:434] conv3_3 <- conv3_2
I1217 21:35:13.685802 19936 net.cpp:408] conv3_3 -> conv3_3
I1217 21:35:13.690228 19936 net.cpp:150] Setting up conv3_3
I1217 21:35:13.690260 19936 net.cpp:157] Top shape: 4 256 56 56 (3211264)
I1217 21:35:13.690263 19936 net.cpp:165] Memory required for data: 394182704
I1217 21:35:13.690270 19936 layer_factory.hpp:77] Creating layer relu3_3
I1217 21:35:13.690279 19936 net.cpp:100] Creating Layer relu3_3
I1217 21:35:13.690284 19936 net.cpp:434] relu3_3 <- conv3_3
I1217 21:35:13.690291 19936 net.cpp:395] relu3_3 -> conv3_3 (in-place)
I1217 21:35:13.690446 19936 net.cpp:150] Setting up relu3_3
I1217 21:35:13.690454 19936 net.cpp:157] Top shape: 4 256 56 56 (3211264)
I1217 21:35:13.690455 19936 net.cpp:165] Memory required for data: 407027760
I1217 21:35:13.690457 19936 layer_factory.hpp:77] Creating layer pool3
I1217 21:35:13.690464 19936 net.cpp:100] Creating Layer pool3
I1217 21:35:13.690466 19936 net.cpp:434] pool3 <- conv3_3
I1217 21:35:13.690470 19936 net.cpp:408] pool3 -> pool3
I1217 21:35:13.690903 19936 net.cpp:150] Setting up pool3
I1217 21:35:13.690914 19936 net.cpp:157] Top shape: 4 256 28 28 (802816)
I1217 21:35:13.690927 19936 net.cpp:165] Memory required for data: 410239024
I1217 21:35:13.690930 19936 layer_factory.hpp:77] Creating layer conv4_1
I1217 21:35:13.690940 19936 net.cpp:100] Creating Layer conv4_1
I1217 21:35:13.690946 19936 net.cpp:434] conv4_1 <- pool3
I1217 21:35:13.690953 19936 net.cpp:408] conv4_1 -> conv4_1
I1217 21:35:13.699327 19936 net.cpp:150] Setting up conv4_1
I1217 21:35:13.699350 19936 net.cpp:157] Top shape: 4 512 28 28 (1605632)
I1217 21:35:13.699353 19936 net.cpp:165] Memory required for data: 416661552
I1217 21:35:13.699360 19936 layer_factory.hpp:77] Creating layer relu4_1
I1217 21:35:13.699368 19936 net.cpp:100] Creating Layer relu4_1
I1217 21:35:13.699373 19936 net.cpp:434] relu4_1 <- conv4_1
I1217 21:35:13.699383 19936 net.cpp:395] relu4_1 -> conv4_1 (in-place)
I1217 21:35:13.699517 19936 net.cpp:150] Setting up relu4_1
I1217 21:35:13.699525 19936 net.cpp:157] Top shape: 4 512 28 28 (1605632)
I1217 21:35:13.699527 19936 net.cpp:165] Memory required for data: 423084080
I1217 21:35:13.699530 19936 layer_factory.hpp:77] Creating layer conv4_2
I1217 21:35:13.699540 19936 net.cpp:100] Creating Layer conv4_2
I1217 21:35:13.699544 19936 net.cpp:434] conv4_2 <- conv4_1
I1217 21:35:13.699548 19936 net.cpp:408] conv4_2 -> conv4_2
I1217 21:35:13.713269 19936 net.cpp:150] Setting up conv4_2
I1217 21:35:13.713301 19936 net.cpp:157] Top shape: 4 512 28 28 (1605632)
I1217 21:35:13.713304 19936 net.cpp:165] Memory required for data: 429506608
I1217 21:35:13.713316 19936 layer_factory.hpp:77] Creating layer relu4_2
I1217 21:35:13.713325 19936 net.cpp:100] Creating Layer relu4_2
I1217 21:35:13.713332 19936 net.cpp:434] relu4_2 <- conv4_2
I1217 21:35:13.713340 19936 net.cpp:395] relu4_2 -> conv4_2 (in-place)
I1217 21:35:13.713502 19936 net.cpp:150] Setting up relu4_2
I1217 21:35:13.713511 19936 net.cpp:157] Top shape: 4 512 28 28 (1605632)
I1217 21:35:13.713523 19936 net.cpp:165] Memory required for data: 435929136
I1217 21:35:13.713526 19936 layer_factory.hpp:77] Creating layer conv4_3
I1217 21:35:13.713537 19936 net.cpp:100] Creating Layer conv4_3
I1217 21:35:13.713553 19936 net.cpp:434] conv4_3 <- conv4_2
I1217 21:35:13.713560 19936 net.cpp:408] conv4_3 -> conv4_3
I1217 21:35:13.727238 19936 net.cpp:150] Setting up conv4_3
I1217 21:35:13.727270 19936 net.cpp:157] Top shape: 4 512 28 28 (1605632)
I1217 21:35:13.727274 19936 net.cpp:165] Memory required for data: 442351664
I1217 21:35:13.727282 19936 layer_factory.hpp:77] Creating layer relu4_3
I1217 21:35:13.727291 19936 net.cpp:100] Creating Layer relu4_3
I1217 21:35:13.727299 19936 net.cpp:434] relu4_3 <- conv4_3
I1217 21:35:13.727309 19936 net.cpp:395] relu4_3 -> conv4_3 (in-place)
I1217 21:35:13.727463 19936 net.cpp:150] Setting up relu4_3
I1217 21:35:13.727470 19936 net.cpp:157] Top shape: 4 512 28 28 (1605632)
I1217 21:35:13.727483 19936 net.cpp:165] Memory required for data: 448774192
I1217 21:35:13.727485 19936 layer_factory.hpp:77] Creating layer pool4
I1217 21:35:13.727491 19936 net.cpp:100] Creating Layer pool4
I1217 21:35:13.727510 19936 net.cpp:434] pool4 <- conv4_3
I1217 21:35:13.727521 19936 net.cpp:408] pool4 -> pool4
I1217 21:35:13.727684 19936 net.cpp:150] Setting up pool4
I1217 21:35:13.727692 19936 net.cpp:157] Top shape: 4 512 14 14 (401408)
I1217 21:35:13.727697 19936 net.cpp:165] Memory required for data: 450379824
I1217 21:35:13.727704 19936 layer_factory.hpp:77] Creating layer conv5_1
I1217 21:35:13.727716 19936 net.cpp:100] Creating Layer conv5_1
I1217 21:35:13.727723 19936 net.cpp:434] conv5_1 <- pool4
I1217 21:35:13.727733 19936 net.cpp:408] conv5_1 -> conv5_1
I1217 21:35:13.742108 19936 net.cpp:150] Setting up conv5_1
I1217 21:35:13.742141 19936 net.cpp:157] Top shape: 4 512 14 14 (401408)
I1217 21:35:13.742144 19936 net.cpp:165] Memory required for data: 451985456
I1217 21:35:13.742151 19936 layer_factory.hpp:77] Creating layer relu5_1
I1217 21:35:13.742161 19936 net.cpp:100] Creating Layer relu5_1
I1217 21:35:13.742166 19936 net.cpp:434] relu5_1 <- conv5_1
I1217 21:35:13.742173 19936 net.cpp:395] relu5_1 -> conv5_1 (in-place)
I1217 21:35:13.742599 19936 net.cpp:150] Setting up relu5_1
I1217 21:35:13.742609 19936 net.cpp:157] Top shape: 4 512 14 14 (401408)
I1217 21:35:13.742622 19936 net.cpp:165] Memory required for data: 453591088
I1217 21:35:13.742624 19936 layer_factory.hpp:77] Creating layer conv5_2
I1217 21:35:13.742635 19936 net.cpp:100] Creating Layer conv5_2
I1217 21:35:13.742642 19936 net.cpp:434] conv5_2 <- conv5_1
I1217 21:35:13.742660 19936 net.cpp:408] conv5_2 -> conv5_2
I1217 21:35:13.756417 19936 net.cpp:150] Setting up conv5_2
I1217 21:35:13.756451 19936 net.cpp:157] Top shape: 4 512 14 14 (401408)
I1217 21:35:13.756454 19936 net.cpp:165] Memory required for data: 455196720
I1217 21:35:13.756461 19936 layer_factory.hpp:77] Creating layer relu5_2
I1217 21:35:13.756471 19936 net.cpp:100] Creating Layer relu5_2
I1217 21:35:13.756475 19936 net.cpp:434] relu5_2 <- conv5_2
I1217 21:35:13.756481 19936 net.cpp:395] relu5_2 -> conv5_2 (in-place)
I1217 21:35:13.756639 19936 net.cpp:150] Setting up relu5_2
I1217 21:35:13.756647 19936 net.cpp:157] Top shape: 4 512 14 14 (401408)
I1217 21:35:13.756659 19936 net.cpp:165] Memory required for data: 456802352
I1217 21:35:13.756662 19936 layer_factory.hpp:77] Creating layer conv5_3
I1217 21:35:13.756672 19936 net.cpp:100] Creating Layer conv5_3
I1217 21:35:13.756678 19936 net.cpp:434] conv5_3 <- conv5_2
I1217 21:35:13.756696 19936 net.cpp:408] conv5_3 -> conv5_3
I1217 21:35:13.770681 19936 net.cpp:150] Setting up conv5_3
I1217 21:35:13.770714 19936 net.cpp:157] Top shape: 4 512 14 14 (401408)
I1217 21:35:13.770717 19936 net.cpp:165] Memory required for data: 458407984
I1217 21:35:13.770725 19936 layer_factory.hpp:77] Creating layer relu5_3
I1217 21:35:13.770733 19936 net.cpp:100] Creating Layer relu5_3
I1217 21:35:13.770740 19936 net.cpp:434] relu5_3 <- conv5_3
I1217 21:35:13.770745 19936 net.cpp:395] relu5_3 -> conv5_3 (in-place)
I1217 21:35:13.770902 19936 net.cpp:150] Setting up relu5_3
I1217 21:35:13.770910 19936 net.cpp:157] Top shape: 4 512 14 14 (401408)
I1217 21:35:13.770923 19936 net.cpp:165] Memory required for data: 460013616
I1217 21:35:13.770925 19936 layer_factory.hpp:77] Creating layer pool5
I1217 21:35:13.770937 19936 net.cpp:100] Creating Layer pool5
I1217 21:35:13.770953 19936 net.cpp:434] pool5 <- conv5_3
I1217 21:35:13.770961 19936 net.cpp:408] pool5 -> pool5
I1217 21:35:13.771142 19936 net.cpp:150] Setting up pool5
I1217 21:35:13.771149 19936 net.cpp:157] Top shape: 4 512 7 7 (100352)
I1217 21:35:13.771162 19936 net.cpp:165] Memory required for data: 460415024
I1217 21:35:13.771164 19936 layer_factory.hpp:77] Creating layer fc6
I1217 21:35:13.771175 19936 net.cpp:100] Creating Layer fc6
I1217 21:35:13.771181 19936 net.cpp:434] fc6 <- pool5
I1217 21:35:13.771190 19936 net.cpp:408] fc6 -> fc6
I1217 21:35:15.909103 19936 net.cpp:150] Setting up fc6
I1217 21:35:15.909142 19936 net.cpp:157] Top shape: 4 4096 (16384)
I1217 21:35:15.909145 19936 net.cpp:165] Memory required for data: 460480560
I1217 21:35:15.909153 19936 layer_factory.hpp:77] Creating layer relu6
I1217 21:35:15.909180 19936 net.cpp:100] Creating Layer relu6
I1217 21:35:15.909188 19936 net.cpp:434] relu6 <- fc6
I1217 21:35:15.909205 19936 net.cpp:395] relu6 -> fc6 (in-place)
I1217 21:35:15.909867 19936 net.cpp:150] Setting up relu6
I1217 21:35:15.909878 19936 net.cpp:157] Top shape: 4 4096 (16384)
I1217 21:35:15.909891 19936 net.cpp:165] Memory required for data: 460546096
I1217 21:35:15.909894 19936 layer_factory.hpp:77] Creating layer drop6
I1217 21:35:15.909899 19936 net.cpp:100] Creating Layer drop6
I1217 21:35:15.909904 19936 net.cpp:434] drop6 <- fc6
I1217 21:35:15.909910 19936 net.cpp:395] drop6 -> fc6 (in-place)
I1217 21:35:15.909946 19936 net.cpp:150] Setting up drop6
I1217 21:35:15.909956 19936 net.cpp:157] Top shape: 4 4096 (16384)
I1217 21:35:15.909961 19936 net.cpp:165] Memory required for data: 460611632
I1217 21:35:15.909965 19936 layer_factory.hpp:77] Creating layer fc7
I1217 21:35:15.909976 19936 net.cpp:100] Creating Layer fc7
I1217 21:35:15.909981 19936 net.cpp:434] fc7 <- fc6
I1217 21:35:15.909988 19936 net.cpp:408] fc7 -> fc7
I1217 21:35:16.260048 19936 net.cpp:150] Setting up fc7
I1217 21:35:16.260083 19936 net.cpp:157] Top shape: 4 4096 (16384)
I1217 21:35:16.260087 19936 net.cpp:165] Memory required for data: 460677168
I1217 21:35:16.260094 19936 layer_factory.hpp:77] Creating layer relu7
I1217 21:35:16.260102 19936 net.cpp:100] Creating Layer relu7
I1217 21:35:16.260107 19936 net.cpp:434] relu7 <- fc7
I1217 21:35:16.260114 19936 net.cpp:395] relu7 -> fc7 (in-place)
I1217 21:35:16.260321 19936 net.cpp:150] Setting up relu7
I1217 21:35:16.260331 19936 net.cpp:157] Top shape: 4 4096 (16384)
I1217 21:35:16.260345 19936 net.cpp:165] Memory required for data: 460742704
I1217 21:35:16.260350 19936 layer_factory.hpp:77] Creating layer drop7
I1217 21:35:16.260356 19936 net.cpp:100] Creating Layer drop7
I1217 21:35:16.260360 19936 net.cpp:434] drop7 <- fc7
I1217 21:35:16.260370 19936 net.cpp:395] drop7 -> fc7 (in-place)
I1217 21:35:16.260403 19936 net.cpp:150] Setting up drop7
I1217 21:35:16.260414 19936 net.cpp:157] Top shape: 4 4096 (16384)
I1217 21:35:16.260419 19936 net.cpp:165] Memory required for data: 460808240
I1217 21:35:16.260423 19936 layer_factory.hpp:77] Creating layer fc7_drop7_0_split
I1217 21:35:16.260432 19936 net.cpp:100] Creating Layer fc7_drop7_0_split
I1217 21:35:16.260437 19936 net.cpp:434] fc7_drop7_0_split <- fc7
I1217 21:35:16.260445 19936 net.cpp:408] fc7_drop7_0_split -> fc7_drop7_0_split_0
I1217 21:35:16.260454 19936 net.cpp:408] fc7_drop7_0_split -> fc7_drop7_0_split_1
I1217 21:35:16.260496 19936 net.cpp:150] Setting up fc7_drop7_0_split
I1217 21:35:16.260504 19936 net.cpp:157] Top shape: 4 4096 (16384)
I1217 21:35:16.260509 19936 net.cpp:157] Top shape: 4 4096 (16384)
I1217 21:35:16.260514 19936 net.cpp:165] Memory required for data: 460939312
I1217 21:35:16.260519 19936 layer_factory.hpp:77] Creating layer fc8-1
I1217 21:35:16.260529 19936 net.cpp:100] Creating Layer fc8-1
I1217 21:35:16.260535 19936 net.cpp:434] fc8-1 <- fc7_drop7_0_split_0
I1217 21:35:16.260546 19936 net.cpp:408] fc8-1 -> fc8-1
I1217 21:35:16.261391 19936 net.cpp:150] Setting up fc8-1
I1217 21:35:16.261400 19936 net.cpp:157] Top shape: 4 9 (36)
I1217 21:35:16.261411 19936 net.cpp:165] Memory required for data: 460939456
I1217 21:35:16.261421 19936 layer_factory.hpp:77] Creating layer euclidean
I1217 21:35:16.261435 19936 net.cpp:100] Creating Layer euclidean
I1217 21:35:16.261441 19936 net.cpp:434] euclidean <- fc7_drop7_0_split_1
I1217 21:35:16.261449 19936 net.cpp:434] euclidean <- label_data_1_split_0
I1217 21:35:16.261459 19936 net.cpp:408] euclidean -> euclidean
I1217 21:35:16.261469 19936 net.cpp:408] euclidean -> label_dif
I1217 21:35:16.261519 19936 net.cpp:150] Setting up euclidean
I1217 21:35:16.261526 19936 net.cpp:157] Top shape: 2 4096 1 1 (8192)
I1217 21:35:16.261531 19936 net.cpp:157] Top shape: 2 (2)
I1217 21:35:16.261538 19936 net.cpp:165] Memory required for data: 460972232
I1217 21:35:16.261543 19936 layer_factory.hpp:77] Creating layer fc8-1_dif
I1217 21:35:16.261565 19936 net.cpp:100] Creating Layer fc8-1_dif
I1217 21:35:16.261574 19936 net.cpp:434] fc8-1_dif <- euclidean
I1217 21:35:16.261581 19936 net.cpp:408] fc8-1_dif -> fc8-1_dif
I1217 21:35:16.261828 19936 net.cpp:150] Setting up fc8-1_dif
I1217 21:35:16.261837 19936 net.cpp:157] Top shape: 2 2 (4)
I1217 21:35:16.261842 19936 net.cpp:165] Memory required for data: 460972248
I1217 21:35:16.261857 19936 layer_factory.hpp:77] Creating layer loss
I1217 21:35:16.261868 19936 net.cpp:100] Creating Layer loss
I1217 21:35:16.261874 19936 net.cpp:434] loss <- fc8-1
I1217 21:35:16.261881 19936 net.cpp:434] loss <- label_data_1_split_1
I1217 21:35:16.261889 19936 net.cpp:408] loss -> loss
I1217 21:35:16.261900 19936 layer_factory.hpp:77] Creating layer loss
I1217 21:35:16.262120 19936 net.cpp:150] Setting up loss
I1217 21:35:16.262130 19936 net.cpp:157] Top shape: (1)
I1217 21:35:16.262135 19936 net.cpp:160]     with loss weight 0.5
I1217 21:35:16.262156 19936 net.cpp:165] Memory required for data: 460972252
I1217 21:35:16.262162 19936 layer_factory.hpp:77] Creating layer loss_dif
I1217 21:35:16.262171 19936 net.cpp:100] Creating Layer loss_dif
I1217 21:35:16.262176 19936 net.cpp:434] loss_dif <- fc8-1_dif
I1217 21:35:16.262183 19936 net.cpp:434] loss_dif <- label_dif
I1217 21:35:16.262190 19936 net.cpp:408] loss_dif -> loss_dif
I1217 21:35:16.262197 19936 layer_factory.hpp:77] Creating layer loss_dif
I1217 21:35:16.262779 19936 net.cpp:150] Setting up loss_dif
I1217 21:35:16.262790 19936 net.cpp:157] Top shape: (1)
I1217 21:35:16.262795 19936 net.cpp:160]     with loss weight 0.2
I1217 21:35:16.262800 19936 net.cpp:165] Memory required for data: 460972256
I1217 21:35:16.262804 19936 net.cpp:226] loss_dif needs backward computation.
I1217 21:35:16.262806 19936 net.cpp:226] loss needs backward computation.
I1217 21:35:16.262809 19936 net.cpp:226] fc8-1_dif needs backward computation.
I1217 21:35:16.262811 19936 net.cpp:226] euclidean needs backward computation.
I1217 21:35:16.262814 19936 net.cpp:226] fc8-1 needs backward computation.
I1217 21:35:16.262816 19936 net.cpp:226] fc7_drop7_0_split needs backward computation.
I1217 21:35:16.262820 19936 net.cpp:226] drop7 needs backward computation.
I1217 21:35:16.262821 19936 net.cpp:226] relu7 needs backward computation.
I1217 21:35:16.262823 19936 net.cpp:226] fc7 needs backward computation.
I1217 21:35:16.262826 19936 net.cpp:226] drop6 needs backward computation.
I1217 21:35:16.262828 19936 net.cpp:226] relu6 needs backward computation.
I1217 21:35:16.262830 19936 net.cpp:226] fc6 needs backward computation.
I1217 21:35:16.262832 19936 net.cpp:226] pool5 needs backward computation.
I1217 21:35:16.262835 19936 net.cpp:226] relu5_3 needs backward computation.
I1217 21:35:16.262837 19936 net.cpp:226] conv5_3 needs backward computation.
I1217 21:35:16.262840 19936 net.cpp:226] relu5_2 needs backward computation.
I1217 21:35:16.262842 19936 net.cpp:226] conv5_2 needs backward computation.
I1217 21:35:16.262845 19936 net.cpp:226] relu5_1 needs backward computation.
I1217 21:35:16.262846 19936 net.cpp:226] conv5_1 needs backward computation.
I1217 21:35:16.262850 19936 net.cpp:226] pool4 needs backward computation.
I1217 21:35:16.262852 19936 net.cpp:226] relu4_3 needs backward computation.
I1217 21:35:16.262854 19936 net.cpp:226] conv4_3 needs backward computation.
I1217 21:35:16.262857 19936 net.cpp:226] relu4_2 needs backward computation.
I1217 21:35:16.262859 19936 net.cpp:226] conv4_2 needs backward computation.
I1217 21:35:16.262861 19936 net.cpp:226] relu4_1 needs backward computation.
I1217 21:35:16.262864 19936 net.cpp:226] conv4_1 needs backward computation.
I1217 21:35:16.262866 19936 net.cpp:226] pool3 needs backward computation.
I1217 21:35:16.262869 19936 net.cpp:226] relu3_3 needs backward computation.
I1217 21:35:16.262871 19936 net.cpp:226] conv3_3 needs backward computation.
I1217 21:35:16.262873 19936 net.cpp:226] relu3_2 needs backward computation.
I1217 21:35:16.262876 19936 net.cpp:226] conv3_2 needs backward computation.
I1217 21:35:16.262887 19936 net.cpp:226] relu3_1 needs backward computation.
I1217 21:35:16.262889 19936 net.cpp:226] conv3_1 needs backward computation.
I1217 21:35:16.262892 19936 net.cpp:228] pool2 does not need backward computation.
I1217 21:35:16.262894 19936 net.cpp:228] relu2_2 does not need backward computation.
I1217 21:35:16.262897 19936 net.cpp:228] conv2_2 does not need backward computation.
I1217 21:35:16.262899 19936 net.cpp:228] relu2_1 does not need backward computation.
I1217 21:35:16.262902 19936 net.cpp:228] conv2_1 does not need backward computation.
I1217 21:35:16.262904 19936 net.cpp:228] pool1 does not need backward computation.
I1217 21:35:16.262907 19936 net.cpp:228] relu1_2 does not need backward computation.
I1217 21:35:16.262909 19936 net.cpp:228] conv1_2 does not need backward computation.
I1217 21:35:16.262912 19936 net.cpp:228] relu1_1 does not need backward computation.
I1217 21:35:16.262913 19936 net.cpp:228] conv1_1 does not need backward computation.
I1217 21:35:16.262917 19936 net.cpp:228] label_data_1_split does not need backward computation.
I1217 21:35:16.262919 19936 net.cpp:228] data does not need backward computation.
I1217 21:35:16.262922 19936 net.cpp:270] This network produces output loss
I1217 21:35:16.262924 19936 net.cpp:270] This network produces output loss_dif
I1217 21:35:16.262943 19936 net.cpp:283] Network initialization done.
I1217 21:35:16.263494 19936 solver.cpp:181] Creating test net (#0) specified by net file: models/apple_disease/train_val_vgg16_reid.prototxt
I1217 21:35:16.263533 19936 net.cpp:322] The NetState phase (1) differed from the phase (0) specified by a rule in layer data
I1217 21:35:16.263676 19936 net.cpp:58] Initializing net from parameters: 
state {
  phase: TEST
}
layer {
  name: "data"
  type: "ImageData"
  top: "data"
  top: "label"
  include {
    phase: TEST
  }
  transform_param {
    mirror: false
    crop_size: 224
    mean_value: 102.691
    mean_value: 128.77
    mean_value: 131.293
  }
  image_data_param {
    source: "data/apple_disease/val.txt"
    batch_size: 2
    new_height: 256
    new_width: 256
    root_folder: "/media/agwang/\346\226\260\345\212\240\345\215\267/DataSets/Competitions/AppleDiseases/"
  }
}
layer {
  name: "conv1_1"
  type: "Convolution"
  bottom: "data"
  top: "conv1_1"
  param {
    lr_mult: 0
  }
  param {
    lr_mult: 0
  }
  convolution_param {
    num_output: 64
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "xavier"
    }
  }
}
layer {
  name: "relu1_1"
  type: "ReLU"
  bottom: "conv1_1"
  top: "conv1_1"
}
layer {
  name: "conv1_2"
  type: "Convolution"
  bottom: "conv1_1"
  top: "conv1_2"
  param {
    lr_mult: 0
  }
  param {
    lr_mult: 0
  }
  convolution_param {
    num_output: 64
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "xavier"
    }
  }
}
layer {
  name: "relu1_2"
  type: "ReLU"
  bottom: "conv1_2"
  top: "conv1_2"
}
layer {
  name: "pool1"
  type: "Pooling"
  bottom: "conv1_2"
  top: "pool1"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "conv2_1"
  type: "Convolution"
  bottom: "pool1"
  top: "conv2_1"
  param {
    lr_mult: 0
  }
  param {
    lr_mult: 0
  }
  convolution_param {
    num_output: 128
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "xavier"
    }
  }
}
layer {
  name: "relu2_1"
  type: "ReLU"
  bottom: "conv2_1"
  top: "conv2_1"
}
layer {
  name: "conv2_2"
  type: "Convolution"
  bottom: "conv2_1"
  top: "conv2_2"
  param {
    lr_mult: 0
  }
  param {
    lr_mult: 0
  }
  convolution_param {
    num_output: 128
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "xavier"
    }
  }
}
layer {
  name: "relu2_2"
  type: "ReLU"
  bottom: "conv2_2"
  top: "conv2_2"
}
layer {
  name: "pool2"
  type: "Pooling"
  bottom: "conv2_2"
  top: "pool2"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "conv3_1"
  type: "Convolution"
  bottom: "pool2"
  top: "conv3_1"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "xavier"
    }
  }
}
layer {
  name: "relu3_1"
  type: "ReLU"
  bottom: "conv3_1"
  top: "conv3_1"
}
layer {
  name: "conv3_2"
  type: "Convolution"
  bottom: "conv3_1"
  top: "conv3_2"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "xavier"
    }
  }
}
layer {
  name: "relu3_2"
  type: "ReLU"
  bottom: "conv3_2"
  top: "conv3_2"
}
layer {
  name: "conv3_3"
  type: "Convolution"
  bottom: "conv3_2"
  top: "conv3_3"
  convolution_param {
    num_output: 256
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "xavier"
    }
  }
}
layer {
  name: "relu3_3"
  type: "ReLU"
  bottom: "conv3_3"
  top: "conv3_3"
}
layer {
  name: "pool3"
  type: "Pooling"
  bottom: "conv3_3"
  top: "pool3"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "conv4_1"
  type: "Convolution"
  bottom: "pool3"
  top: "conv4_1"
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "xavier"
    }
  }
}
layer {
  name: "relu4_1"
  type: "ReLU"
  bottom: "conv4_1"
  top: "conv4_1"
}
layer {
  name: "conv4_2"
  type: "Convolution"
  bottom: "conv4_1"
  top: "conv4_2"
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "xavier"
    }
  }
}
layer {
  name: "relu4_2"
  type: "ReLU"
  bottom: "conv4_2"
  top: "conv4_2"
}
layer {
  name: "conv4_3"
  type: "Convolution"
  bottom: "conv4_2"
  top: "conv4_3"
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "xavier"
    }
  }
}
layer {
  name: "relu4_3"
  type: "ReLU"
  bottom: "conv4_3"
  top: "conv4_3"
}
layer {
  name: "pool4"
  type: "Pooling"
  bottom: "conv4_3"
  top: "pool4"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "conv5_1"
  type: "Convolution"
  bottom: "pool4"
  top: "conv5_1"
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "xavier"
    }
  }
}
layer {
  name: "relu5_1"
  type: "ReLU"
  bottom: "conv5_1"
  top: "conv5_1"
}
layer {
  name: "conv5_2"
  type: "Convolution"
  bottom: "conv5_1"
  top: "conv5_2"
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "xavier"
    }
  }
}
layer {
  name: "relu5_2"
  type: "ReLU"
  bottom: "conv5_2"
  top: "conv5_2"
}
layer {
  name: "conv5_3"
  type: "Convolution"
  bottom: "conv5_2"
  top: "conv5_3"
  convolution_param {
    num_output: 512
    pad: 1
    kernel_size: 3
    weight_filler {
      type: "xavier"
    }
  }
}
layer {
  name: "relu5_3"
  type: "ReLU"
  bottom: "conv5_3"
  top: "conv5_3"
}
layer {
  name: "pool5"
  type: "Pooling"
  bottom: "conv5_3"
  top: "pool5"
  pooling_param {
    pool: MAX
    kernel_size: 2
    stride: 2
  }
}
layer {
  name: "fc6"
  type: "InnerProduct"
  bottom: "pool5"
  top: "fc6"
  inner_product_param {
    num_output: 4096
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
  }
}
layer {
  name: "relu6"
  type: "ReLU"
  bottom: "fc6"
  top: "fc6"
}
layer {
  name: "drop6"
  type: "Dropout"
  bottom: "fc6"
  top: "fc6"
  dropout_param {
    dropout_ratio: 0.6
  }
}
layer {
  name: "fc7"
  type: "InnerProduct"
  bottom: "fc6"
  top: "fc7"
  inner_product_param {
    num_output: 4096
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
  }
}
layer {
  name: "relu7"
  type: "ReLU"
  bottom: "fc7"
  top: "fc7"
}
layer {
  name: "drop7"
  type: "Dropout"
  bottom: "fc7"
  top: "fc7"
  dropout_param {
    dropout_ratio: 0.6
  }
}
layer {
  name: "fc8-1"
  type: "InnerProduct"
  bottom: "fc7"
  top: "fc8-1"
  inner_product_param {
    num_output: 9
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
  }
}
layer {
  name: "euclidean"
  type: "PairEuclidean"
  bottom: "fc7"
  bottom: "label"
  top: "euclidean"
  top: "label_dif"
}
layer {
  name: "fc8-1_dif"
  type: "InnerProduct"
  bottom: "euclidean"
  top: "fc8-1_dif"
  inner_product_param {
    num_output: 2
    weight_filler {
      type: "gaussian"
      std: 0.01
    }
  }
}
layer {
  name: "loss"
  type: "SoftmaxWithLoss"
  bottom: "fc8-1"
  bottom: "label"
  top: "loss"
  loss_weight: 0.5
  propagate_down: true
  propagate_down: false
}
layer {
  name: "loss_dif"
  type: "SoftmaxWithLoss"
  bottom: "fc8-1_dif"
  bottom: "label_dif"
  top: "loss_dif"
  loss_weight: 0.2
  propagate_down: true
  propagate_down: false
}
layer {
  name: "accuracy"
  type: "Accuracy"
  bottom: "fc8-1"
  bottom: "label"
  top: "accuracy"
  include {
    phase: TEST
  }
}
I1217 21:35:16.263795 19936 layer_factory.hpp:77] Creating layer data
I1217 21:35:16.263808 19936 net.cpp:100] Creating Layer data
I1217 21:35:16.263813 19936 net.cpp:408] data -> data
I1217 21:35:16.263818 19936 net.cpp:408] data -> label
I1217 21:35:16.263825 19936 image_data_layer.cpp:41] Opening file data/apple_disease/val.txt
I1217 21:35:16.263952 19936 image_data_layer.cpp:61] A total of 557 images.
I1217 21:35:16.265072 19936 image_data_layer.cpp:88] output data size: 2,3,224,224
I1217 21:35:16.268440 19936 net.cpp:150] Setting up data
I1217 21:35:16.268465 19936 net.cpp:157] Top shape: 2 3 224 224 (301056)
I1217 21:35:16.268471 19936 net.cpp:157] Top shape: 2 (2)
I1217 21:35:16.268476 19936 net.cpp:165] Memory required for data: 1204232
I1217 21:35:16.268481 19936 layer_factory.hpp:77] Creating layer label_data_1_split
I1217 21:35:16.268494 19936 net.cpp:100] Creating Layer label_data_1_split
I1217 21:35:16.268501 19936 net.cpp:434] label_data_1_split <- label
I1217 21:35:16.268508 19936 net.cpp:408] label_data_1_split -> label_data_1_split_0
I1217 21:35:16.268520 19936 net.cpp:408] label_data_1_split -> label_data_1_split_1
I1217 21:35:16.268527 19936 net.cpp:408] label_data_1_split -> label_data_1_split_2
I1217 21:35:16.268579 19936 net.cpp:150] Setting up label_data_1_split
I1217 21:35:16.268586 19936 net.cpp:157] Top shape: 2 (2)
I1217 21:35:16.268591 19936 net.cpp:157] Top shape: 2 (2)
I1217 21:35:16.268597 19936 net.cpp:157] Top shape: 2 (2)
I1217 21:35:16.268602 19936 net.cpp:165] Memory required for data: 1204256
I1217 21:35:16.268606 19936 layer_factory.hpp:77] Creating layer conv1_1
I1217 21:35:16.268620 19936 net.cpp:100] Creating Layer conv1_1
I1217 21:35:16.268623 19936 net.cpp:434] conv1_1 <- data
I1217 21:35:16.268630 19936 net.cpp:408] conv1_1 -> conv1_1
I1217 21:35:16.269603 19936 net.cpp:150] Setting up conv1_1
I1217 21:35:16.269618 19936 net.cpp:157] Top shape: 2 64 224 224 (6422528)
I1217 21:35:16.269621 19936 net.cpp:165] Memory required for data: 26894368
I1217 21:35:16.269634 19936 layer_factory.hpp:77] Creating layer relu1_1
I1217 21:35:16.269641 19936 net.cpp:100] Creating Layer relu1_1
I1217 21:35:16.269647 19936 net.cpp:434] relu1_1 <- conv1_1
I1217 21:35:16.269655 19936 net.cpp:395] relu1_1 -> conv1_1 (in-place)
I1217 21:35:16.270093 19936 net.cpp:150] Setting up relu1_1
I1217 21:35:16.270104 19936 net.cpp:157] Top shape: 2 64 224 224 (6422528)
I1217 21:35:16.270109 19936 net.cpp:165] Memory required for data: 52584480
I1217 21:35:16.270114 19936 layer_factory.hpp:77] Creating layer conv1_2
I1217 21:35:16.270126 19936 net.cpp:100] Creating Layer conv1_2
I1217 21:35:16.270131 19936 net.cpp:434] conv1_2 <- conv1_1
I1217 21:35:16.270139 19936 net.cpp:408] conv1_2 -> conv1_2
I1217 21:35:16.271350 19936 net.cpp:150] Setting up conv1_2
I1217 21:35:16.271371 19936 net.cpp:157] Top shape: 2 64 224 224 (6422528)
I1217 21:35:16.271376 19936 net.cpp:165] Memory required for data: 78274592
I1217 21:35:16.271387 19936 layer_factory.hpp:77] Creating layer relu1_2
I1217 21:35:16.271399 19936 net.cpp:100] Creating Layer relu1_2
I1217 21:35:16.271405 19936 net.cpp:434] relu1_2 <- conv1_2
I1217 21:35:16.271414 19936 net.cpp:395] relu1_2 -> conv1_2 (in-place)
I1217 21:35:16.272074 19936 net.cpp:150] Setting up relu1_2
I1217 21:35:16.272089 19936 net.cpp:157] Top shape: 2 64 224 224 (6422528)
I1217 21:35:16.272094 19936 net.cpp:165] Memory required for data: 103964704
I1217 21:35:16.272099 19936 layer_factory.hpp:77] Creating layer pool1
I1217 21:35:16.272111 19936 net.cpp:100] Creating Layer pool1
I1217 21:35:16.272130 19936 net.cpp:434] pool1 <- conv1_2
I1217 21:35:16.272140 19936 net.cpp:408] pool1 -> pool1
I1217 21:35:16.272308 19936 net.cpp:150] Setting up pool1
I1217 21:35:16.272316 19936 net.cpp:157] Top shape: 2 64 112 112 (1605632)
I1217 21:35:16.272320 19936 net.cpp:165] Memory required for data: 110387232
I1217 21:35:16.272321 19936 layer_factory.hpp:77] Creating layer conv2_1
I1217 21:35:16.272330 19936 net.cpp:100] Creating Layer conv2_1
I1217 21:35:16.272334 19936 net.cpp:434] conv2_1 <- pool1
I1217 21:35:16.272338 19936 net.cpp:408] conv2_1 -> conv2_1
I1217 21:35:16.273947 19936 net.cpp:150] Setting up conv2_1
I1217 21:35:16.273964 19936 net.cpp:157] Top shape: 2 128 112 112 (3211264)
I1217 21:35:16.273968 19936 net.cpp:165] Memory required for data: 123232288
I1217 21:35:16.273977 19936 layer_factory.hpp:77] Creating layer relu2_1
I1217 21:35:16.273988 19936 net.cpp:100] Creating Layer relu2_1
I1217 21:35:16.273990 19936 net.cpp:434] relu2_1 <- conv2_1
I1217 21:35:16.273994 19936 net.cpp:395] relu2_1 -> conv2_1 (in-place)
I1217 21:35:16.274135 19936 net.cpp:150] Setting up relu2_1
I1217 21:35:16.274142 19936 net.cpp:157] Top shape: 2 128 112 112 (3211264)
I1217 21:35:16.274147 19936 net.cpp:165] Memory required for data: 136077344
I1217 21:35:16.274148 19936 layer_factory.hpp:77] Creating layer conv2_2
I1217 21:35:16.274155 19936 net.cpp:100] Creating Layer conv2_2
I1217 21:35:16.274158 19936 net.cpp:434] conv2_2 <- conv2_1
I1217 21:35:16.274163 19936 net.cpp:408] conv2_2 -> conv2_2
I1217 21:35:16.276111 19936 net.cpp:150] Setting up conv2_2
I1217 21:35:16.276129 19936 net.cpp:157] Top shape: 2 128 112 112 (3211264)
I1217 21:35:16.276130 19936 net.cpp:165] Memory required for data: 148922400
I1217 21:35:16.276136 19936 layer_factory.hpp:77] Creating layer relu2_2
I1217 21:35:16.276144 19936 net.cpp:100] Creating Layer relu2_2
I1217 21:35:16.276147 19936 net.cpp:434] relu2_2 <- conv2_2
I1217 21:35:16.276154 19936 net.cpp:395] relu2_2 -> conv2_2 (in-place)
I1217 21:35:16.276302 19936 net.cpp:150] Setting up relu2_2
I1217 21:35:16.276310 19936 net.cpp:157] Top shape: 2 128 112 112 (3211264)
I1217 21:35:16.276314 19936 net.cpp:165] Memory required for data: 161767456
I1217 21:35:16.276315 19936 layer_factory.hpp:77] Creating layer pool2
I1217 21:35:16.276321 19936 net.cpp:100] Creating Layer pool2
I1217 21:35:16.276324 19936 net.cpp:434] pool2 <- conv2_2
I1217 21:35:16.276329 19936 net.cpp:408] pool2 -> pool2
I1217 21:35:16.276775 19936 net.cpp:150] Setting up pool2
I1217 21:35:16.276787 19936 net.cpp:157] Top shape: 2 128 56 56 (802816)
I1217 21:35:16.276790 19936 net.cpp:165] Memory required for data: 164978720
I1217 21:35:16.276793 19936 layer_factory.hpp:77] Creating layer conv3_1
I1217 21:35:16.276801 19936 net.cpp:100] Creating Layer conv3_1
I1217 21:35:16.276805 19936 net.cpp:434] conv3_1 <- pool2
I1217 21:35:16.276810 19936 net.cpp:408] conv3_1 -> conv3_1
I1217 21:35:16.279604 19936 net.cpp:150] Setting up conv3_1
I1217 21:35:16.279626 19936 net.cpp:157] Top shape: 2 256 56 56 (1605632)
I1217 21:35:16.279629 19936 net.cpp:165] Memory required for data: 171401248
I1217 21:35:16.279640 19936 layer_factory.hpp:77] Creating layer relu3_1
I1217 21:35:16.279649 19936 net.cpp:100] Creating Layer relu3_1
I1217 21:35:16.279654 19936 net.cpp:434] relu3_1 <- conv3_1
I1217 21:35:16.279659 19936 net.cpp:395] relu3_1 -> conv3_1 (in-place)
I1217 21:35:16.280087 19936 net.cpp:150] Setting up relu3_1
I1217 21:35:16.280097 19936 net.cpp:157] Top shape: 2 256 56 56 (1605632)
I1217 21:35:16.280110 19936 net.cpp:165] Memory required for data: 177823776
I1217 21:35:16.280112 19936 layer_factory.hpp:77] Creating layer conv3_2
I1217 21:35:16.280120 19936 net.cpp:100] Creating Layer conv3_2
I1217 21:35:16.280124 19936 net.cpp:434] conv3_2 <- conv3_1
I1217 21:35:16.280129 19936 net.cpp:408] conv3_2 -> conv3_2
I1217 21:35:16.284626 19936 net.cpp:150] Setting up conv3_2
I1217 21:35:16.284656 19936 net.cpp:157] Top shape: 2 256 56 56 (1605632)
I1217 21:35:16.284658 19936 net.cpp:165] Memory required for data: 184246304
I1217 21:35:16.284678 19936 layer_factory.hpp:77] Creating layer relu3_2
I1217 21:35:16.284687 19936 net.cpp:100] Creating Layer relu3_2
I1217 21:35:16.284693 19936 net.cpp:434] relu3_2 <- conv3_2
I1217 21:35:16.284698 19936 net.cpp:395] relu3_2 -> conv3_2 (in-place)
I1217 21:35:16.284837 19936 net.cpp:150] Setting up relu3_2
I1217 21:35:16.284845 19936 net.cpp:157] Top shape: 2 256 56 56 (1605632)
I1217 21:35:16.284848 19936 net.cpp:165] Memory required for data: 190668832
I1217 21:35:16.284852 19936 layer_factory.hpp:77] Creating layer conv3_3
I1217 21:35:16.284862 19936 net.cpp:100] Creating Layer conv3_3
I1217 21:35:16.284867 19936 net.cpp:434] conv3_3 <- conv3_2
I1217 21:35:16.284870 19936 net.cpp:408] conv3_3 -> conv3_3
I1217 21:35:16.290374 19936 net.cpp:150] Setting up conv3_3
I1217 21:35:16.290393 19936 net.cpp:157] Top shape: 2 256 56 56 (1605632)
I1217 21:35:16.290396 19936 net.cpp:165] Memory required for data: 197091360
I1217 21:35:16.290405 19936 layer_factory.hpp:77] Creating layer relu3_3
I1217 21:35:16.290416 19936 net.cpp:100] Creating Layer relu3_3
I1217 21:35:16.290426 19936 net.cpp:434] relu3_3 <- conv3_3
I1217 21:35:16.290434 19936 net.cpp:395] relu3_3 -> conv3_3 (in-place)
I1217 21:35:16.290587 19936 net.cpp:150] Setting up relu3_3
I1217 21:35:16.290596 19936 net.cpp:157] Top shape: 2 256 56 56 (1605632)
I1217 21:35:16.290601 19936 net.cpp:165] Memory required for data: 203513888
I1217 21:35:16.290606 19936 layer_factory.hpp:77] Creating layer pool3
I1217 21:35:16.290617 19936 net.cpp:100] Creating Layer pool3
I1217 21:35:16.290624 19936 net.cpp:434] pool3 <- conv3_3
I1217 21:35:16.290632 19936 net.cpp:408] pool3 -> pool3
I1217 21:35:16.290807 19936 net.cpp:150] Setting up pool3
I1217 21:35:16.290817 19936 net.cpp:157] Top shape: 2 256 28 28 (401408)
I1217 21:35:16.290819 19936 net.cpp:165] Memory required for data: 205119520
I1217 21:35:16.290822 19936 layer_factory.hpp:77] Creating layer conv4_1
I1217 21:35:16.290833 19936 net.cpp:100] Creating Layer conv4_1
I1217 21:35:16.290840 19936 net.cpp:434] conv4_1 <- pool3
I1217 21:35:16.290848 19936 net.cpp:408] conv4_1 -> conv4_1
I1217 21:35:16.298717 19936 net.cpp:150] Setting up conv4_1
I1217 21:35:16.298748 19936 net.cpp:157] Top shape: 2 512 28 28 (802816)
I1217 21:35:16.298753 19936 net.cpp:165] Memory required for data: 208330784
I1217 21:35:16.298759 19936 layer_factory.hpp:77] Creating layer relu4_1
I1217 21:35:16.298768 19936 net.cpp:100] Creating Layer relu4_1
I1217 21:35:16.298774 19936 net.cpp:434] relu4_1 <- conv4_1
I1217 21:35:16.298781 19936 net.cpp:395] relu4_1 -> conv4_1 (in-place)
I1217 21:35:16.298943 19936 net.cpp:150] Setting up relu4_1
I1217 21:35:16.298951 19936 net.cpp:157] Top shape: 2 512 28 28 (802816)
I1217 21:35:16.298964 19936 net.cpp:165] Memory required for data: 211542048
I1217 21:35:16.298966 19936 layer_factory.hpp:77] Creating layer conv4_2
I1217 21:35:16.298976 19936 net.cpp:100] Creating Layer conv4_2
I1217 21:35:16.298982 19936 net.cpp:434] conv4_2 <- conv4_1
I1217 21:35:16.299000 19936 net.cpp:408] conv4_2 -> conv4_2
I1217 21:35:16.312660 19936 net.cpp:150] Setting up conv4_2
I1217 21:35:16.312695 19936 net.cpp:157] Top shape: 2 512 28 28 (802816)
I1217 21:35:16.312698 19936 net.cpp:165] Memory required for data: 214753312
I1217 21:35:16.312710 19936 layer_factory.hpp:77] Creating layer relu4_2
I1217 21:35:16.312719 19936 net.cpp:100] Creating Layer relu4_2
I1217 21:35:16.312728 19936 net.cpp:434] relu4_2 <- conv4_2
I1217 21:35:16.312737 19936 net.cpp:395] relu4_2 -> conv4_2 (in-place)
I1217 21:35:16.313185 19936 net.cpp:150] Setting up relu4_2
I1217 21:35:16.313196 19936 net.cpp:157] Top shape: 2 512 28 28 (802816)
I1217 21:35:16.313200 19936 net.cpp:165] Memory required for data: 217964576
I1217 21:35:16.313207 19936 layer_factory.hpp:77] Creating layer conv4_3
I1217 21:35:16.313220 19936 net.cpp:100] Creating Layer conv4_3
I1217 21:35:16.313227 19936 net.cpp:434] conv4_3 <- conv4_2
I1217 21:35:16.313238 19936 net.cpp:408] conv4_3 -> conv4_3
I1217 21:35:16.327345 19936 net.cpp:150] Setting up conv4_3
I1217 21:35:16.327399 19936 net.cpp:157] Top shape: 2 512 28 28 (802816)
I1217 21:35:16.327402 19936 net.cpp:165] Memory required for data: 221175840
I1217 21:35:16.327409 19936 layer_factory.hpp:77] Creating layer relu4_3
I1217 21:35:16.327419 19936 net.cpp:100] Creating Layer relu4_3
I1217 21:35:16.327425 19936 net.cpp:434] relu4_3 <- conv4_3
I1217 21:35:16.327435 19936 net.cpp:395] relu4_3 -> conv4_3 (in-place)
I1217 21:35:16.327590 19936 net.cpp:150] Setting up relu4_3
I1217 21:35:16.327600 19936 net.cpp:157] Top shape: 2 512 28 28 (802816)
I1217 21:35:16.327605 19936 net.cpp:165] Memory required for data: 224387104
I1217 21:35:16.327608 19936 layer_factory.hpp:77] Creating layer pool4
I1217 21:35:16.327620 19936 net.cpp:100] Creating Layer pool4
I1217 21:35:16.327625 19936 net.cpp:434] pool4 <- conv4_3
I1217 21:35:16.327633 19936 net.cpp:408] pool4 -> pool4
I1217 21:35:16.327803 19936 net.cpp:150] Setting up pool4
I1217 21:35:16.327812 19936 net.cpp:157] Top shape: 2 512 14 14 (200704)
I1217 21:35:16.327817 19936 net.cpp:165] Memory required for data: 225189920
I1217 21:35:16.327823 19936 layer_factory.hpp:77] Creating layer conv5_1
I1217 21:35:16.327836 19936 net.cpp:100] Creating Layer conv5_1
I1217 21:35:16.327843 19936 net.cpp:434] conv5_1 <- pool4
I1217 21:35:16.327854 19936 net.cpp:408] conv5_1 -> conv5_1
I1217 21:35:16.341528 19936 net.cpp:150] Setting up conv5_1
I1217 21:35:16.341560 19936 net.cpp:157] Top shape: 2 512 14 14 (200704)
I1217 21:35:16.341564 19936 net.cpp:165] Memory required for data: 225992736
I1217 21:35:16.341572 19936 layer_factory.hpp:77] Creating layer relu5_1
I1217 21:35:16.341581 19936 net.cpp:100] Creating Layer relu5_1
I1217 21:35:16.341586 19936 net.cpp:434] relu5_1 <- conv5_1
I1217 21:35:16.341593 19936 net.cpp:395] relu5_1 -> conv5_1 (in-place)
I1217 21:35:16.341754 19936 net.cpp:150] Setting up relu5_1
I1217 21:35:16.341763 19936 net.cpp:157] Top shape: 2 512 14 14 (200704)
I1217 21:35:16.341775 19936 net.cpp:165] Memory required for data: 226795552
I1217 21:35:16.341778 19936 layer_factory.hpp:77] Creating layer conv5_2
I1217 21:35:16.341787 19936 net.cpp:100] Creating Layer conv5_2
I1217 21:35:16.341791 19936 net.cpp:434] conv5_2 <- conv5_1
I1217 21:35:16.341804 19936 net.cpp:408] conv5_2 -> conv5_2
I1217 21:35:16.355979 19936 net.cpp:150] Setting up conv5_2
I1217 21:35:16.356003 19936 net.cpp:157] Top shape: 2 512 14 14 (200704)
I1217 21:35:16.356006 19936 net.cpp:165] Memory required for data: 227598368
I1217 21:35:16.356014 19936 layer_factory.hpp:77] Creating layer relu5_2
I1217 21:35:16.356021 19936 net.cpp:100] Creating Layer relu5_2
I1217 21:35:16.356025 19936 net.cpp:434] relu5_2 <- conv5_2
I1217 21:35:16.356031 19936 net.cpp:395] relu5_2 -> conv5_2 (in-place)
I1217 21:35:16.356220 19936 net.cpp:150] Setting up relu5_2
I1217 21:35:16.356228 19936 net.cpp:157] Top shape: 2 512 14 14 (200704)
I1217 21:35:16.356241 19936 net.cpp:165] Memory required for data: 228401184
I1217 21:35:16.356245 19936 layer_factory.hpp:77] Creating layer conv5_3
I1217 21:35:16.356252 19936 net.cpp:100] Creating Layer conv5_3
I1217 21:35:16.356257 19936 net.cpp:434] conv5_3 <- conv5_2
I1217 21:35:16.356263 19936 net.cpp:408] conv5_3 -> conv5_3
I1217 21:35:16.369808 19936 net.cpp:150] Setting up conv5_3
I1217 21:35:16.369840 19936 net.cpp:157] Top shape: 2 512 14 14 (200704)
I1217 21:35:16.369844 19936 net.cpp:165] Memory required for data: 229204000
I1217 21:35:16.369851 19936 layer_factory.hpp:77] Creating layer relu5_3
I1217 21:35:16.369861 19936 net.cpp:100] Creating Layer relu5_3
I1217 21:35:16.369866 19936 net.cpp:434] relu5_3 <- conv5_3
I1217 21:35:16.369873 19936 net.cpp:395] relu5_3 -> conv5_3 (in-place)
I1217 21:35:16.370324 19936 net.cpp:150] Setting up relu5_3
I1217 21:35:16.370334 19936 net.cpp:157] Top shape: 2 512 14 14 (200704)
I1217 21:35:16.370347 19936 net.cpp:165] Memory required for data: 230006816
I1217 21:35:16.370350 19936 layer_factory.hpp:77] Creating layer pool5
I1217 21:35:16.370362 19936 net.cpp:100] Creating Layer pool5
I1217 21:35:16.370367 19936 net.cpp:434] pool5 <- conv5_3
I1217 21:35:16.370389 19936 net.cpp:408] pool5 -> pool5
I1217 21:35:16.370586 19936 net.cpp:150] Setting up pool5
I1217 21:35:16.370596 19936 net.cpp:157] Top shape: 2 512 7 7 (50176)
I1217 21:35:16.370599 19936 net.cpp:165] Memory required for data: 230207520
I1217 21:35:16.370605 19936 layer_factory.hpp:77] Creating layer fc6
I1217 21:35:16.370615 19936 net.cpp:100] Creating Layer fc6
I1217 21:35:16.370620 19936 net.cpp:434] fc6 <- pool5
I1217 21:35:16.370627 19936 net.cpp:408] fc6 -> fc6
I1217 21:35:18.528064 19936 net.cpp:150] Setting up fc6
I1217 21:35:18.528183 19936 net.cpp:157] Top shape: 2 4096 (8192)
I1217 21:35:18.528198 19936 net.cpp:165] Memory required for data: 230240288
I1217 21:35:18.528214 19936 layer_factory.hpp:77] Creating layer relu6
I1217 21:35:18.528226 19936 net.cpp:100] Creating Layer relu6
I1217 21:35:18.528232 19936 net.cpp:434] relu6 <- fc6
I1217 21:35:18.528237 19936 net.cpp:395] relu6 -> fc6 (in-place)
I1217 21:35:18.528434 19936 net.cpp:150] Setting up relu6
I1217 21:35:18.528441 19936 net.cpp:157] Top shape: 2 4096 (8192)
I1217 21:35:18.528445 19936 net.cpp:165] Memory required for data: 230273056
I1217 21:35:18.528456 19936 layer_factory.hpp:77] Creating layer drop6
I1217 21:35:18.528465 19936 net.cpp:100] Creating Layer drop6
I1217 21:35:18.528468 19936 net.cpp:434] drop6 <- fc6
I1217 21:35:18.528471 19936 net.cpp:395] drop6 -> fc6 (in-place)
I1217 21:35:18.528494 19936 net.cpp:150] Setting up drop6
I1217 21:35:18.528499 19936 net.cpp:157] Top shape: 2 4096 (8192)
I1217 21:35:18.528501 19936 net.cpp:165] Memory required for data: 230305824
I1217 21:35:18.528504 19936 layer_factory.hpp:77] Creating layer fc7
I1217 21:35:18.528511 19936 net.cpp:100] Creating Layer fc7
I1217 21:35:18.528513 19936 net.cpp:434] fc7 <- fc6
I1217 21:35:18.528517 19936 net.cpp:408] fc7 -> fc7
I1217 21:35:18.881825 19936 net.cpp:150] Setting up fc7
I1217 21:35:18.881851 19936 net.cpp:157] Top shape: 2 4096 (8192)
I1217 21:35:18.881855 19936 net.cpp:165] Memory required for data: 230338592
I1217 21:35:18.881872 19936 layer_factory.hpp:77] Creating layer relu7
I1217 21:35:18.881881 19936 net.cpp:100] Creating Layer relu7
I1217 21:35:18.881886 19936 net.cpp:434] relu7 <- fc7
I1217 21:35:18.881891 19936 net.cpp:395] relu7 -> fc7 (in-place)
I1217 21:35:18.882517 19936 net.cpp:150] Setting up relu7
I1217 21:35:18.882529 19936 net.cpp:157] Top shape: 2 4096 (8192)
I1217 21:35:18.882530 19936 net.cpp:165] Memory required for data: 230371360
I1217 21:35:18.882544 19936 layer_factory.hpp:77] Creating layer drop7
I1217 21:35:18.882552 19936 net.cpp:100] Creating Layer drop7
I1217 21:35:18.882557 19936 net.cpp:434] drop7 <- fc7
I1217 21:35:18.882560 19936 net.cpp:395] drop7 -> fc7 (in-place)
I1217 21:35:18.882588 19936 net.cpp:150] Setting up drop7
I1217 21:35:18.882593 19936 net.cpp:157] Top shape: 2 4096 (8192)
I1217 21:35:18.882596 19936 net.cpp:165] Memory required for data: 230404128
I1217 21:35:18.882608 19936 layer_factory.hpp:77] Creating layer fc7_drop7_0_split
I1217 21:35:18.882612 19936 net.cpp:100] Creating Layer fc7_drop7_0_split
I1217 21:35:18.882616 19936 net.cpp:434] fc7_drop7_0_split <- fc7
I1217 21:35:18.882630 19936 net.cpp:408] fc7_drop7_0_split -> fc7_drop7_0_split_0
I1217 21:35:18.882637 19936 net.cpp:408] fc7_drop7_0_split -> fc7_drop7_0_split_1
I1217 21:35:18.882666 19936 net.cpp:150] Setting up fc7_drop7_0_split
I1217 21:35:18.882683 19936 net.cpp:157] Top shape: 2 4096 (8192)
I1217 21:35:18.882685 19936 net.cpp:157] Top shape: 2 4096 (8192)
I1217 21:35:18.882688 19936 net.cpp:165] Memory required for data: 230469664
I1217 21:35:18.882699 19936 layer_factory.hpp:77] Creating layer fc8-1
I1217 21:35:18.882705 19936 net.cpp:100] Creating Layer fc8-1
I1217 21:35:18.882709 19936 net.cpp:434] fc8-1 <- fc7_drop7_0_split_0
I1217 21:35:18.882714 19936 net.cpp:408] fc8-1 -> fc8-1
I1217 21:35:18.883558 19936 net.cpp:150] Setting up fc8-1
I1217 21:35:18.883566 19936 net.cpp:157] Top shape: 2 9 (18)
I1217 21:35:18.883570 19936 net.cpp:165] Memory required for data: 230469736
I1217 21:35:18.883574 19936 layer_factory.hpp:77] Creating layer fc8-1_fc8-1_0_split
I1217 21:35:18.883579 19936 net.cpp:100] Creating Layer fc8-1_fc8-1_0_split
I1217 21:35:18.883581 19936 net.cpp:434] fc8-1_fc8-1_0_split <- fc8-1
I1217 21:35:18.883585 19936 net.cpp:408] fc8-1_fc8-1_0_split -> fc8-1_fc8-1_0_split_0
I1217 21:35:18.883589 19936 net.cpp:408] fc8-1_fc8-1_0_split -> fc8-1_fc8-1_0_split_1
I1217 21:35:18.883616 19936 net.cpp:150] Setting up fc8-1_fc8-1_0_split
I1217 21:35:18.883622 19936 net.cpp:157] Top shape: 2 9 (18)
I1217 21:35:18.883625 19936 net.cpp:157] Top shape: 2 9 (18)
I1217 21:35:18.883637 19936 net.cpp:165] Memory required for data: 230469880
I1217 21:35:18.883641 19936 layer_factory.hpp:77] Creating layer euclidean
I1217 21:35:18.883646 19936 net.cpp:100] Creating Layer euclidean
I1217 21:35:18.883647 19936 net.cpp:434] euclidean <- fc7_drop7_0_split_1
I1217 21:35:18.883651 19936 net.cpp:434] euclidean <- label_data_1_split_0
I1217 21:35:18.883656 19936 net.cpp:408] euclidean -> euclidean
I1217 21:35:18.883661 19936 net.cpp:408] euclidean -> label_dif
I1217 21:35:18.883707 19936 net.cpp:150] Setting up euclidean
I1217 21:35:18.883713 19936 net.cpp:157] Top shape: 1 4096 1 1 (4096)
I1217 21:35:18.883714 19936 net.cpp:157] Top shape: 1 (1)
I1217 21:35:18.883716 19936 net.cpp:165] Memory required for data: 230486268
I1217 21:35:18.883719 19936 layer_factory.hpp:77] Creating layer fc8-1_dif
I1217 21:35:18.883723 19936 net.cpp:100] Creating Layer fc8-1_dif
I1217 21:35:18.883725 19936 net.cpp:434] fc8-1_dif <- euclidean
I1217 21:35:18.883730 19936 net.cpp:408] fc8-1_dif -> fc8-1_dif
I1217 21:35:18.883980 19936 net.cpp:150] Setting up fc8-1_dif
I1217 21:35:18.883987 19936 net.cpp:157] Top shape: 1 2 (2)
I1217 21:35:18.883991 19936 net.cpp:165] Memory required for data: 230486276
I1217 21:35:18.883997 19936 layer_factory.hpp:77] Creating layer loss
I1217 21:35:18.884004 19936 net.cpp:100] Creating Layer loss
I1217 21:35:18.884008 19936 net.cpp:434] loss <- fc8-1_fc8-1_0_split_0
I1217 21:35:18.884012 19936 net.cpp:434] loss <- label_data_1_split_1
I1217 21:35:18.884016 19936 net.cpp:408] loss -> loss
I1217 21:35:18.884021 19936 layer_factory.hpp:77] Creating layer loss
I1217 21:35:18.884584 19936 net.cpp:150] Setting up loss
I1217 21:35:18.884598 19936 net.cpp:157] Top shape: (1)
I1217 21:35:18.884603 19936 net.cpp:160]     with loss weight 0.5
I1217 21:35:18.884620 19936 net.cpp:165] Memory required for data: 230486280
I1217 21:35:18.884627 19936 layer_factory.hpp:77] Creating layer loss_dif
I1217 21:35:18.884635 19936 net.cpp:100] Creating Layer loss_dif
I1217 21:35:18.884641 19936 net.cpp:434] loss_dif <- fc8-1_dif
I1217 21:35:18.884647 19936 net.cpp:434] loss_dif <- label_dif
I1217 21:35:18.884656 19936 net.cpp:408] loss_dif -> loss_dif
I1217 21:35:18.884667 19936 layer_factory.hpp:77] Creating layer loss_dif
I1217 21:35:18.884871 19936 net.cpp:150] Setting up loss_dif
I1217 21:35:18.884881 19936 net.cpp:157] Top shape: (1)
I1217 21:35:18.884884 19936 net.cpp:160]     with loss weight 0.2
I1217 21:35:18.884892 19936 net.cpp:165] Memory required for data: 230486284
I1217 21:35:18.884897 19936 layer_factory.hpp:77] Creating layer accuracy
I1217 21:35:18.884908 19936 net.cpp:100] Creating Layer accuracy
I1217 21:35:18.884913 19936 net.cpp:434] accuracy <- fc8-1_fc8-1_0_split_1
I1217 21:35:18.884920 19936 net.cpp:434] accuracy <- label_data_1_split_2
I1217 21:35:18.884927 19936 net.cpp:408] accuracy -> accuracy
I1217 21:35:18.884938 19936 net.cpp:150] Setting up accuracy
I1217 21:35:18.884943 19936 net.cpp:157] Top shape: (1)
I1217 21:35:18.884948 19936 net.cpp:165] Memory required for data: 230486288
I1217 21:35:18.884954 19936 net.cpp:228] accuracy does not need backward computation.
I1217 21:35:18.884960 19936 net.cpp:226] loss_dif needs backward computation.
I1217 21:35:18.884966 19936 net.cpp:226] loss needs backward computation.
I1217 21:35:18.884973 19936 net.cpp:226] fc8-1_dif needs backward computation.
I1217 21:35:18.884977 19936 net.cpp:226] euclidean needs backward computation.
I1217 21:35:18.884984 19936 net.cpp:226] fc8-1_fc8-1_0_split needs backward computation.
I1217 21:35:18.884989 19936 net.cpp:226] fc8-1 needs backward computation.
I1217 21:35:18.884994 19936 net.cpp:226] fc7_drop7_0_split needs backward computation.
I1217 21:35:18.884997 19936 net.cpp:226] drop7 needs backward computation.
I1217 21:35:18.885000 19936 net.cpp:226] relu7 needs backward computation.
I1217 21:35:18.885005 19936 net.cpp:226] fc7 needs backward computation.
I1217 21:35:18.885010 19936 net.cpp:226] drop6 needs backward computation.
I1217 21:35:18.885015 19936 net.cpp:226] relu6 needs backward computation.
I1217 21:35:18.885026 19936 net.cpp:226] fc6 needs backward computation.
I1217 21:35:18.885032 19936 net.cpp:226] pool5 needs backward computation.
I1217 21:35:18.885038 19936 net.cpp:226] relu5_3 needs backward computation.
I1217 21:35:18.885043 19936 net.cpp:226] conv5_3 needs backward computation.
I1217 21:35:18.885047 19936 net.cpp:226] relu5_2 needs backward computation.
I1217 21:35:18.885052 19936 net.cpp:226] conv5_2 needs backward computation.
I1217 21:35:18.885056 19936 net.cpp:226] relu5_1 needs backward computation.
I1217 21:35:18.885061 19936 net.cpp:226] conv5_1 needs backward computation.
I1217 21:35:18.885067 19936 net.cpp:226] pool4 needs backward computation.
I1217 21:35:18.885073 19936 net.cpp:226] relu4_3 needs backward computation.
I1217 21:35:18.885078 19936 net.cpp:226] conv4_3 needs backward computation.
I1217 21:35:18.885083 19936 net.cpp:226] relu4_2 needs backward computation.
I1217 21:35:18.885088 19936 net.cpp:226] conv4_2 needs backward computation.
I1217 21:35:18.885094 19936 net.cpp:226] relu4_1 needs backward computation.
I1217 21:35:18.885099 19936 net.cpp:226] conv4_1 needs backward computation.
I1217 21:35:18.885105 19936 net.cpp:226] pool3 needs backward computation.
I1217 21:35:18.885110 19936 net.cpp:226] relu3_3 needs backward computation.
I1217 21:35:18.885116 19936 net.cpp:226] conv3_3 needs backward computation.
I1217 21:35:18.885121 19936 net.cpp:226] relu3_2 needs backward computation.
I1217 21:35:18.885126 19936 net.cpp:226] conv3_2 needs backward computation.
I1217 21:35:18.885131 19936 net.cpp:226] relu3_1 needs backward computation.
I1217 21:35:18.885135 19936 net.cpp:226] conv3_1 needs backward computation.
I1217 21:35:18.885140 19936 net.cpp:228] pool2 does not need backward computation.
I1217 21:35:18.885148 19936 net.cpp:228] relu2_2 does not need backward computation.
I1217 21:35:18.885152 19936 net.cpp:228] conv2_2 does not need backward computation.
I1217 21:35:18.885156 19936 net.cpp:228] relu2_1 does not need backward computation.
I1217 21:35:18.885161 19936 net.cpp:228] conv2_1 does not need backward computation.
I1217 21:35:18.885167 19936 net.cpp:228] pool1 does not need backward computation.
I1217 21:35:18.885174 19936 net.cpp:228] relu1_2 does not need backward computation.
I1217 21:35:18.885179 19936 net.cpp:228] conv1_2 does not need backward computation.
I1217 21:35:18.885185 19936 net.cpp:228] relu1_1 does not need backward computation.
I1217 21:35:18.885190 19936 net.cpp:228] conv1_1 does not need backward computation.
I1217 21:35:18.885195 19936 net.cpp:228] label_data_1_split does not need backward computation.
I1217 21:35:18.885201 19936 net.cpp:228] data does not need backward computation.
I1217 21:35:18.885206 19936 net.cpp:270] This network produces output accuracy
I1217 21:35:18.885210 19936 net.cpp:270] This network produces output loss
I1217 21:35:18.885216 19936 net.cpp:270] This network produces output loss_dif
I1217 21:35:18.885241 19936 net.cpp:283] Network initialization done.
I1217 21:35:18.885349 19936 solver.cpp:60] Solver scaffolding done.
I1217 21:35:18.886317 19936 caffe.cpp:251] Starting Optimization
I1217 21:35:18.886327 19936 solver.cpp:279] Solving 
I1217 21:35:18.886330 19936 solver.cpp:280] Learning Rate Policy: step
I1217 21:35:18.890858 19936 solver.cpp:337] Iteration 0, Testing net (#0)
I1217 21:35:19.304390 19936 blocking_queue.cpp:50] Data layer prefetch queue empty
I1217 21:35:19.455142 19936 solver.cpp:404]     Test net output #0: accuracy = 0.4
I1217 21:35:19.455209 19936 solver.cpp:404]     Test net output #1: loss = 1.84567 (* 0.5 = 0.922837 loss)
I1217 21:35:19.455219 19936 solver.cpp:404]     Test net output #2: loss_dif = 0.676259 (* 0.2 = 0.135252 loss)
I1217 21:35:19.486976 19936 solver.cpp:228] Iteration 0, loss = 1.33693
I1217 21:35:19.487025 19936 solver.cpp:244]     Train net output #0: loss = 2.67385 (* 0.5 = 1.33693 loss)
I1217 21:35:19.487037 19936 solver.cpp:244]     Train net output #1: loss_dif = 5.96047e-08 (* 0.2 = 1.19209e-08 loss)
I1217 21:35:19.487056 19936 sgd_solver.cpp:106] Iteration 0, lr = 0.0001
I1217 21:35:25.224709 19936 solver.cpp:228] Iteration 100, loss = 1.19417
I1217 21:35:25.224756 19936 solver.cpp:244]     Train net output #0: loss = 1.95124 (* 0.5 = 0.975619 loss)
I1217 21:35:25.224763 19936 solver.cpp:244]     Train net output #1: loss_dif = 0.701315 (* 0.2 = 0.140263 loss)
I1217 21:35:25.224771 19936 sgd_solver.cpp:106] Iteration 100, lr = 0.0001
I1217 21:35:30.958261 19936 solver.cpp:228] Iteration 200, loss = 1.24081
I1217 21:35:30.958305 19936 solver.cpp:244]     Train net output #0: loss = 2.31596 (* 0.5 = 1.15798 loss)
I1217 21:35:30.958313 19936 solver.cpp:244]     Train net output #1: loss_dif = 0.756224 (* 0.2 = 0.151245 loss)
I1217 21:35:30.958320 19936 sgd_solver.cpp:106] Iteration 200, lr = 0.0001
I1217 21:35:36.695291 19936 solver.cpp:228] Iteration 300, loss = 1.23359
I1217 21:35:36.695319 19936 solver.cpp:244]     Train net output #0: loss = 2.14226 (* 0.5 = 1.07113 loss)
I1217 21:35:36.695327 19936 solver.cpp:244]     Train net output #1: loss_dif = 0.813939 (* 0.2 = 0.162788 loss)
I1217 21:35:36.695334 19936 sgd_solver.cpp:106] Iteration 300, lr = 0.0001
I1217 21:35:42.448040 19936 solver.cpp:228] Iteration 400, loss = 1.22914
I1217 21:35:42.448083 19936 solver.cpp:244]     Train net output #0: loss = 2.3363 (* 0.5 = 1.16815 loss)
I1217 21:35:42.448089 19936 solver.cpp:244]     Train net output #1: loss_dif = 0.595037 (* 0.2 = 0.119007 loss)
I1217 21:35:42.448096 19936 sgd_solver.cpp:106] Iteration 400, lr = 0.0001
